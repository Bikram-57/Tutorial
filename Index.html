<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result Analysis Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
</head>

<body>
    <div id="container">
        <h1 class="text-center">Result Analysis</h1>
        <div class="mb-3">
            <label for="formFile" class="form-label mx-5" id="labelid">Choose a File</label>
            <input class="form-control mx-5" type="file" id="formFile" accept="xlsx,xls,xlsm,xltx,xltm,csv,ods">
        </div>
        <div class="position-absolute top-50 start-50 translate-middle">
            <button type="button" id="myButton" class="btn btn-outline-primary mx-5 ">Uplode</button>
        </div>

        <!-- <div id="fileContent" class="mx-5 mt-3"></div>

        <script>
            document.getElementById('myButton').addEventListener('click', function () {
                var input = document.getElementById('formFile');
                var file = input.files[0];

                if (file) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        // Display the file content in the 'fileContent' div
                        document.getElementById('fileContent').innerText = e.target.result;
                    };

                    // Read the file as text
                    reader.readAsText(file);
                } else {
                    alert('Please choose a file before uploading.');
                }
            });
        </script> -->

         <!-- Display the Excel data here -->
         <div id="excelData" class="mx-5 mt-3"></div>

         <script>
             document.getElementById('myButton').addEventListener('click', function () {
                 var input = document.getElementById('formFile');
                 var file = input.files[0];
 
                 if (file) {
                     var reader = new FileReader();
 
                     reader.onload = function (e) {
                         var data = new Uint8Array(e.target.result);
                         var workbook = XLSX.read(data, { type: 'array' });
 
                         // Assuming you have a single sheet in the Excel file
                         var sheetName = workbook.SheetNames[0];
                         var excelData = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], { header: 1 });
 
                         // Display the Excel data in the 'excelData' div
                         document.getElementById('excelData').innerText = JSON.stringify(excelData, null, 2);
                     };
 
                     // Read the file as binary data
                     reader.readAsArrayBuffer(file);
                 } else {
                     alert('Please choose an Excel file before uploading.');
                 }
             });
         </script>
     </div>
</body>

</html>